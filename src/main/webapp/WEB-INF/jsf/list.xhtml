<ui:composition xmlns="http://www.w3.org/1999/xhtml" template="#{deviceResourceHandler.resolveSimpleTemplate()}"
	xmlns:ui="http://java.sun.com/jsf/facelets" 
	xmlns:h="http://java.sun.com/jsf/html" 
	xmlns:f="http://java.sun.com/jsf/core" 
	xmlns:t="http://myfaces.apache.org/tomahawk" 
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions"
	xmlns:o="http://omnifaces.org/ui"
	xmlns:cegedim="http://java.sun.com/jsf/composite/components">
	<ui:define name="content">
		<style>
			.ui-datatable .ui-datatable-header {
			    text-align: right !important;
			}
		</style>
	
		<div class="card">
			<h:form id="listForm">
				<p:toolbar rendered="true">
					<f:facet name="right">
					</f:facet>
				</p:toolbar>
				<p:dataTable id="dataTable" value="#{patientListPaginator}" widgetVar="dataTableWdg" selection="#{patientListPaginator.selectedItem}"
					lazy="true" paginator="true" var="elemento" rows="#{patientListPaginator.rowsPerPage}" selectionMode="single"
					paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
					paginatorPosition="top" rowsPerPageTemplate="5,10,15,50,75,100" 
					first="#{patientListPaginator.first}" filters="#{patientListPaginator.filters}">
					<p:ajax event="page" listener="#{patientListPaginator.onPageChange}"/>  
					<p:ajax event="filter" listener="#{patientListPaginator.filterListener}"/>
					<f:facet name="header">
			            <p:outputPanel>
			                <span>Search all fields:</span>
			                <p:inputText id="globalFilter" value="#{patientListPaginator.filters['globalFilter']}" onkeyup="PF('dataTableWdg').filter()" style="width:150px" />
			            </p:outputPanel>
			        </f:facet>
			        <p:column headerText="#{bundle['patient.list.name']}">
						<h:outputText value="#{elemento.person.name}" />
					</p:column>
					<p:column headerText="#{bundle['patient.list.surname1']}">
						<h:outputText value="#{elemento.person.surname1}" />
					</p:column>
					<p:column headerText="#{bundle['patient.list.age']}">
						<h:outputText value="#{PatientListController.calculateAge(elemento.person.birthday)} years" />
					</p:column>
					<p:column headerText="#{bundle['patient.list.gender']}">
						<ui:param name="genderText" value="SEXO_#{elemento.person.gender.toUpperCase()}.key" />
						<h:outputText value="#{bundle[genderText]}" />
					</p:column>
					<p:column headerText="#{bundle['patient.list.status']}" width="40" style="text-align: center">
						<h:graphicImage library="custom" name="images/i_bullet_green.png" rendered="#{elemento.person.status eq 'V'}" />
						<h:graphicImage library="custom" name="images/i_bullet_red.png" rendered="#{!elemento.person.status eq 'V'}" />
					</p:column>
					<p:column style="width:32px;text-align: center">
             			<p:link href="#{configParameters.springDispatcherMapping}/patient?id=#{elemento.perId}" rendered="false">
							<i class="fa fa-edit" />
			            </p:link>
			            <p:commandLink action="editItem">
			             	<i class="fa fa-edit" />
			             	<f:param name="idSelected" value="#{elemento.perId}"></f:param>
			            </p:commandLink>
			        </p:column>
			        <p:column style="width:32px;text-align: center">
			            <p:commandLink action="deleteItem">
			             	<i class="fa fa-trash-alt" />
			             	<f:param name="idSelected" value="#{elemento.perId}"></f:param>
			            </p:commandLink>
			        </p:column>
				</p:dataTable>
				<p:toolbar>
					<f:facet name="right">
						<p:button href="#{configParameters.springDispatcherMapping}/patient" value="New Patient" />
					</f:facet>
				</p:toolbar>
			</h:form>
		</div>
	</ui:define>
</ui:composition>
